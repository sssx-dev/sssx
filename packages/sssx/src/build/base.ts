import fs from 'fs'
import url, {fileURLToPath} from 'url'
import path from 'path'
import type { BuildOptions } from "esbuild";

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

const packageJSON = JSON.parse(fs.readFileSync(path.resolve(__dirname, `../../`, `package.json`), {encoding: 'utf-8'}))

const d = new Date()
const date = [d.getFullYear(), d.getMonth(), d.getDate()].join(`-`)

export const BASE:BuildOptions = {
    bundle: true,
    mainFields: ["svelte", "browser", "module", "main"],
    minify: true,
    logLevel: 'info',
    splitting: true,
    format: `esm`,
    banner: {
        js: `// Generated by SSSX v${packageJSON.version} on ${date}`
    }
}